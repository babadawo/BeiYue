<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <link rel="stylesheet" href="../../layui/css/layui.css" media="all" />
    <link rel="stylesheet" href="../../css/public.css" media="all" />
</head>
<body>
<div class="layui-container">
    <form class="layui-form" action="/add" method="post">
        <div class="layui-form-item">
            <label class="layui-form-label">昵称</label>
            <div class="layui-input-block">
                <input type="text" name="nickname" required  lay-verify="required" placeholder="请输入昵称" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">姓名</label>
            <div class="layui-input-block">
                <input type="text" name="name" required  lay-verify="required" placeholder="请输入姓名" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">联系方式</label>
            <div class="layui-input-block">
                <input type="text" name="phone" required  lay-verify="required" placeholder="请输入联系方式" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">地址</label>
            <div class="layui-input-block">
                <input type="text" name="address" required  lay-verify="required" placeholder="请输入地址" autocomplete="off" class="layui-input">
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">角色</label>
            <div class="layui-input-block">
                <select id="roleId" name="role.id" lay-verify="required">

                </select>
            </div>
        </div>

        <div class="layui-form-item">
            <div class="layui-input-block">
                <button class="layui-btn" lay-submit lay-filter="formDemo">立即提交</button>
                <button type="reset" class="layui-btn layui-btn-primary">重置</button>
            </div>
        </div>
    </form>
</div>
</body>
<script src="layui/layui.js"></script>
<script>

    layui.use('table', function(){
        var table = layui.table;
        var $=layui.jquery;
        //第一个实例
        table.render({
            elem: '#mytab'
            ,toolbar:"#addUserToolBar"
            ,url: '/queryUser' //数据接口
            ,page: true //开启分页
            ,cols: [[ //表头
                {type:'checkbox'}
                ,{field: 'id', title: 'ID', width:80, sort: true}
                ,{field: 'nickname', title: '昵称', width:100}
                ,{field: 'name', title: '姓名', width:100}
                ,{field: 'phone', title: '联系方式', width:180}
                ,{field: 'address', title: '地址', width:300}
                ,{field: 'role', title: '角色', width:80, sort: true,templet:function (obj){
                        return obj.role.name;
                    }}
                ,{title: '操作', width:150,toolbar:"#updateUserBar"}
            ]]
        });

        table.on("toolbar()",function (obj){
            //添加事件
            if(obj.event=='addUser'){
                layer.open({
                    type:2,//弹出层类型
                    title:"添加用户",
                    content:"/add.jsp",//弹出层内容
                    area: ['45%', '55%']
                });
            }

        })

        table.on("tool()",function (obj){
            //获取当前用户选择的这行数据
            var data=obj.data;

            if(obj.event=="delUser"){
                layer.confirm("您确定删除吗?",function (index){
                    //请求后台
                    $.ajax({
                        url:"/del/"+data.id,
                        success:function (data){
                            layer.close(index);
                            //删除成功后刷新表格
                            table.reload('mytab',{
                                url: '/queryUser'
                            })
                        }
                    })
                },function (){

                })
            }
            //修改事件
            if(obj.event=='updateUser'){
                layer.open({
                    type:2,//弹出层类型
                    title:"修改用户",
                    content:"/queryById/"+data.id,//弹出层内容弹出层内容弹出层内容
                    area: ['45%', '55%']
                });
            }
        })

    });



</script>
</html>